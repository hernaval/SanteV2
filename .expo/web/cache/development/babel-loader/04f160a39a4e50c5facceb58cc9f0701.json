{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nvar _jsxFileName = \"E:\\\\Projets\\\\Acadys\\\\best4sante\\\\SanteV2\\\\assets\\\\Screens\\\\Emergency.js\";\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React, { Component } from 'react';\nimport Text from \"react-native-web/dist/exports/Text\";\nimport View from \"react-native-web/dist/exports/View\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport Linking from \"react-native-web/dist/exports/Linking\";\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport Button from \"react-native-web/dist/exports/Button\";\nimport { AsyncStorage } from \"react-native-web/dist/index\";\nimport { connect } from 'react-redux';\nimport axios from 'axios';\nimport TopMenu from \"../component/Menu/TopMenu\";\nimport TabBar from \"@mindinventory/react-native-tab-bar-interaction\";\nimport * as Permissions from 'expo-permissions';\nimport * as Location from 'expo-location';\nimport { emergency } from \"../API/emergency\";\nimport { urgency } from \"../API/urgency\";\nimport { widthPercentageToDP as wp, heightPercentageToDP as hp } from 'react-native-responsive-screen';\nimport { TouchableOpacity } from 'react-native-gesture-handler';\nimport Bdd from \"../API/Bdd\";\nimport ViewPager from '@react-native-community/viewpager';\nimport { Avatar } from 'react-native-elements';\nimport { getCurrentLocation } from \"../services/location\";\nimport google from \"../API/google\";\nvar API_KEY = google.cloud_key;\n\nvar Emergency = function (_Component) {\n  _inherits(Emergency, _Component);\n\n  var _super = _createSuper(Emergency);\n\n  function Emergency(props) {\n    var _this;\n\n    _classCallCheck(this, Emergency);\n\n    _this = _super.call(this, props);\n\n    _this.componentDidMount = function _callee() {\n      return _regeneratorRuntime.async(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return _regeneratorRuntime.awrap(_this._getCountryCodeByLocation());\n\n            case 2:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    };\n\n    _this.sendmail = function _callee4(type, msg) {\n      var location, data, idUser;\n      return _regeneratorRuntime.async(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              _context4.next = 2;\n              return _regeneratorRuntime.awrap(getCurrentLocation());\n\n            case 2:\n              location = _context4.sent;\n              data = {\n                typeUrgence: type,\n                geolocUrgence: location.coords.latitude + \",\" + location.coords.longitude,\n                idUser: _this.props.user.user.idUser\n              };\n              idUser = _this.props.user.user.idUser;\n              _context4.next = 7;\n              return _regeneratorRuntime.awrap(axios.post(Bdd.api_url + \"/urgence\", data).then(function _callee2(res) {\n                return _regeneratorRuntime.async(function _callee2$(_context2) {\n                  while (1) {\n                    switch (_context2.prev = _context2.next) {\n                      case 0:\n                        console.log(\"eto le izy \", res.data.data);\n\n                      case 1:\n                      case \"end\":\n                        return _context2.stop();\n                    }\n                  }\n                }, null, null, null, Promise);\n              }));\n\n            case 7:\n              _context4.next = 9;\n              return _regeneratorRuntime.awrap(axios.post(Bdd.api_url + \"/contact/inform/\" + idUser).then(function _callee3(_) {\n                return _regeneratorRuntime.async(function _callee3$(_context3) {\n                  while (1) {\n                    switch (_context3.prev = _context3.next) {\n                      case 0:\n                      case \"end\":\n                        return _context3.stop();\n                    }\n                  }\n                }, null, null, null, Promise);\n              }));\n\n            case 9:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    };\n\n    _this.callUrgence = function _callee5() {\n      var num;\n      return _regeneratorRuntime.async(function _callee5$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n              _context5.next = 2;\n              return _regeneratorRuntime.awrap(_this.findNumber());\n\n            case 2:\n              num = _context5.sent;\n\n              _this.callPerson(num.ambulance);\n\n              _context5.next = 6;\n              return _regeneratorRuntime.awrap(_this.sendmail(\"Malaise\"));\n\n            case 6:\n            case \"end\":\n              return _context5.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    };\n\n    _this.callAccident = function _callee6() {\n      var num;\n      return _regeneratorRuntime.async(function _callee6$(_context6) {\n        while (1) {\n          switch (_context6.prev = _context6.next) {\n            case 0:\n              _context6.next = 2;\n              return _regeneratorRuntime.awrap(_this.findNumber());\n\n            case 2:\n              num = _context6.sent;\n\n              _this.callPerson(num.fire);\n\n              _context6.next = 6;\n              return _regeneratorRuntime.awrap(_this.sendmail(\"Accident\"));\n\n            case 6:\n            case \"end\":\n              return _context6.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    };\n\n    _this.callAgression = function _callee7() {\n      var num;\n      return _regeneratorRuntime.async(function _callee7$(_context7) {\n        while (1) {\n          switch (_context7.prev = _context7.next) {\n            case 0:\n              _context7.next = 2;\n              return _regeneratorRuntime.awrap(_this.findNumber());\n\n            case 2:\n              num = _context7.sent;\n\n              _this.callPerson(num.police);\n\n              _context7.next = 6;\n              return _regeneratorRuntime.awrap(_this.sendmail(\"Agression\"));\n\n            case 6:\n            case \"end\":\n              return _context7.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    };\n\n    _this.callCovid = function _callee8() {\n      var num;\n      return _regeneratorRuntime.async(function _callee8$(_context8) {\n        while (1) {\n          switch (_context8.prev = _context8.next) {\n            case 0:\n              _context8.next = 2;\n              return _regeneratorRuntime.awrap(_this.findNumber());\n\n            case 2:\n              num = _context8.sent;\n\n              _this.callPerson(num.covid);\n\n              _context8.next = 6;\n              return _regeneratorRuntime.awrap(_this.sendmail(\"Covid\"));\n\n            case 6:\n            case \"end\":\n              return _context8.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    };\n\n    _this.findNumber = function _callee9() {\n      var num, urgence;\n      return _regeneratorRuntime.async(function _callee9$(_context9) {\n        while (1) {\n          switch (_context9.prev = _context9.next) {\n            case 0:\n              num = {\n                ambulance: null,\n                fire: null,\n                police: null,\n                covid: null\n              };\n\n              if (_this.urgence.length === 0) {\n                console.log('No urgence');\n              } else {\n                urgence = _this.urgence;\n                console.log(\"urgence\", urgence);\n                num = {\n                  ambulance: urgence[0].Ambulance.All[0],\n                  fire: urgence[0].Fire.All[0],\n                  police: urgence[0].Police.All[0],\n                  covid: urgence[0].Covid.All[0]\n                };\n              }\n\n              console.log(num);\n              return _context9.abrupt(\"return\", num);\n\n            case 4:\n            case \"end\":\n              return _context9.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    };\n\n    _this._getCountryCodeByLocation = function _callee12() {\n      var key, value, location;\n      return _regeneratorRuntime.async(function _callee12$(_context13) {\n        while (1) {\n          switch (_context13.prev = _context13.next) {\n            case 0:\n              key = 'permission_location';\n              _context13.next = 3;\n              return _regeneratorRuntime.awrap(AsyncStorage.getItem(key));\n\n            case 3:\n              value = _context13.sent;\n\n              if (!(value === null)) {\n                _context13.next = 8;\n                break;\n              }\n\n              Alert.alert('Localisation', 'Nous demandons votre permission afin de récuperer votre localisation en référence avec les contacts d\\'urgences', [{\n                text: 'Suivant',\n                onPress: function onPress() {\n                  var _await$Permissions$as, status, location;\n\n                  return _regeneratorRuntime.async(function onPress$(_context11) {\n                    while (1) {\n                      switch (_context11.prev = _context11.next) {\n                        case 0:\n                          _context11.next = 2;\n                          return _regeneratorRuntime.awrap(Permissions.askAsync(Permissions.LOCATION));\n\n                        case 2:\n                          _await$Permissions$as = _context11.sent;\n                          status = _await$Permissions$as.status;\n\n                          if (!(status !== 'granted')) {\n                            _context11.next = 8;\n                            break;\n                          }\n\n                          _this.setState({\n                            errorMessage: 'Permission to access location was denied'\n                          });\n\n                          _context11.next = 14;\n                          break;\n\n                        case 8:\n                          _context11.next = 10;\n                          return _regeneratorRuntime.awrap(Location.getCurrentPositionAsync({}));\n\n                        case 10:\n                          location = _context11.sent;\n                          _context11.next = 13;\n                          return _regeneratorRuntime.awrap(AsyncStorage.setItem(key, 'OK'));\n\n                        case 13:\n                          axios.get(\"https://maps.googleapis.com/maps/api/geocode/json?latlng=\" + location.coords.latitude + \",\" + location.coords.longitude + \"&key=\" + API_KEY).then(function _callee10(response) {\n                            var globalRes, resObj, local, res;\n                            return _regeneratorRuntime.async(function _callee10$(_context10) {\n                              while (1) {\n                                switch (_context10.prev = _context10.next) {\n                                  case 0:\n                                    globalRes = response.data.results[0].address_components;\n                                    _context10.next = 3;\n                                    return _regeneratorRuntime.awrap(globalRes.filter(function (el) {\n                                      return el.types.includes(\"country\");\n                                    }));\n\n                                  case 3:\n                                    resObj = _context10.sent;\n                                    _context10.next = 6;\n                                    return _regeneratorRuntime.awrap(resObj[0].short_name);\n\n                                  case 6:\n                                    local = _context10.sent;\n                                    _this.localCode = local;\n                                    console.log(\"Short name local :\", _this.localCode);\n                                    res = urgency.data.filter(function (el) {\n                                      return el.Country.ISOCode == local;\n                                    });\n                                    _this.urgence = res;\n                                    console.log('Urgence ', _this.urgence.length);\n\n                                  case 12:\n                                  case \"end\":\n                                    return _context10.stop();\n                                }\n                              }\n                            }, null, null, null, Promise);\n                          }).catch(function (err) {\n                            console.log(err);\n                          });\n\n                        case 14:\n                        case \"end\":\n                          return _context11.stop();\n                      }\n                    }\n                  }, null, null, null, Promise);\n                }\n              }]);\n              _context13.next = 12;\n              break;\n\n            case 8:\n              _context13.next = 10;\n              return _regeneratorRuntime.awrap(Location.getCurrentPositionAsync({}));\n\n            case 10:\n              location = _context13.sent;\n              axios.get(\"https://maps.googleapis.com/maps/api/geocode/json?latlng=\" + location.coords.latitude + \",\" + location.coords.longitude + \"&key=\" + API_KEY).then(function _callee11(response) {\n                var globalRes, resObj, local, res;\n                return _regeneratorRuntime.async(function _callee11$(_context12) {\n                  while (1) {\n                    switch (_context12.prev = _context12.next) {\n                      case 0:\n                        globalRes = response.data.results[0].address_components;\n                        _context12.next = 3;\n                        return _regeneratorRuntime.awrap(globalRes.filter(function (el) {\n                          return el.types.includes(\"country\");\n                        }));\n\n                      case 3:\n                        resObj = _context12.sent;\n                        _context12.next = 6;\n                        return _regeneratorRuntime.awrap(resObj[0].short_name);\n\n                      case 6:\n                        local = _context12.sent;\n                        _this.localCode = local;\n                        console.log(\"Short name local :\", _this.localCode);\n                        res = urgency.data.filter(function (el) {\n                          return el.Country.ISOCode == local;\n                        });\n                        _this.urgence = res;\n                        console.log('Urgence ', _this.urgence.length);\n\n                      case 12:\n                      case \"end\":\n                        return _context12.stop();\n                    }\n                  }\n                }, null, null, null, Promise);\n              }).catch(function (err) {\n                console.log(err);\n              });\n\n            case 12:\n            case \"end\":\n              return _context13.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    };\n\n    _this.renderBtn = function (index, url, i) {\n      return React.createElement(TouchableOpacity, {\n        key: i,\n        onPress: function onPress() {\n          _this.setState({\n            current: index\n          });\n\n          _this.viewPager.setPage(index);\n        },\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 236,\n          columnNumber: 9\n        }\n      }, _this.state.current !== index && React.createElement(Avatar, {\n        source: url,\n        rounded: true,\n        size: \"medium\",\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 241,\n          columnNumber: 46\n        }\n      }), _this.state.current === index && React.createElement(Avatar, {\n        source: url,\n        rounded: true,\n        size: \"large\",\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 242,\n          columnNumber: 46\n        }\n      }));\n    };\n\n    _this.urgence = {};\n    _this.localCode = \"\";\n    _this.state = {\n      current: 1\n    };\n    return _this;\n  }\n\n  _createClass(Emergency, [{\n    key: \"callPerson\",\n    value: function callPerson(phone) {\n      console.log('Phone', phone);\n\n      if (phone === undefined || phone === null) {\n        Alert.alert(\"Echec \" + this.localCode, 'Pas de numero joignable', [{\n          text: 'OK',\n          onPress: function onPress() {}\n        }]);\n        return;\n      } else {\n        var url;\n\n        if (Platform.OS === 'ios') {\n          url = 'tel://' + phone;\n        } else if (Platform.OS === 'android') {\n          url = 'tel:' + phone;\n        }\n\n        Linking.canOpenURL(url).then(function (supported) {\n          if (supported) {\n            return Linking.openURL(url).catch(function () {\n              return null;\n            });\n          }\n        });\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var datas = [{\n        index: 0,\n        uri: require(\"../images/accident.png\")\n      }, {\n        index: 1,\n        uri: require(\"../images/malaise.png\")\n      }, {\n        index: 2,\n        uri: require(\"../images/agression.png\")\n      }, {\n        index: 3,\n        uri: require(\"../images/cvo.jpg\")\n      }];\n      return React.createElement(View, {\n        style: styles.container,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 260,\n          columnNumber: 13\n        }\n      }, React.createElement(View, {\n        style: [Platform.OS === 'ios' ? styles.under_ios : styles.under],\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 261,\n          columnNumber: 17\n        }\n      }, React.createElement(TopMenu, {\n        navigation: this.props.navigation,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 262,\n          columnNumber: 21\n        }\n      })), React.createElement(ViewPager, {\n        style: {\n          flexGrow: 1,\n          marginTop: hp('15%')\n        },\n        ref: function ref(viewPager) {\n          _this2.viewPager = viewPager;\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 264,\n          columnNumber: 17\n        }\n      }, React.createElement(View, {\n        style: styles.urgenceContainer,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 270,\n          columnNumber: 21\n        }\n      }, React.createElement(TouchableOpacity, {\n        onPress: function onPress() {\n          return _this2.callAccident();\n        },\n        style: styles.urgenceBtn,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 271,\n          columnNumber: 25\n        }\n      }, React.createElement(Image, {\n        source: require(\"../images/sos.png\"),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 273,\n          columnNumber: 29\n        }\n      }), React.createElement(Text, {\n        style: styles.legend,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 274,\n          columnNumber: 29\n        }\n      }, \"ACCIDENT\"))), React.createElement(View, {\n        style: styles.urgenceContainer,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 277,\n          columnNumber: 21\n        }\n      }, React.createElement(TouchableOpacity, {\n        onPress: function onPress() {\n          return _this2.callUrgence();\n        },\n        style: styles.urgenceBtn,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 278,\n          columnNumber: 25\n        }\n      }, React.createElement(Image, {\n        source: require(\"../images/sos.png\"),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 279,\n          columnNumber: 29\n        }\n      })), React.createElement(Text, {\n        style: styles.legend,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 281,\n          columnNumber: 25\n        }\n      }, \"MALAISE\")), React.createElement(View, {\n        style: styles.urgenceContainer,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 283,\n          columnNumber: 21\n        }\n      }, React.createElement(TouchableOpacity, {\n        onPress: function onPress() {\n          return _this2.callAgression();\n        },\n        style: styles.urgenceBtn,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 284,\n          columnNumber: 25\n        }\n      }, React.createElement(Image, {\n        source: require(\"../images/sos.png\"),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 285,\n          columnNumber: 29\n        }\n      })), React.createElement(Text, {\n        style: styles.legend,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 287,\n          columnNumber: 25\n        }\n      }, \"AGRESSION\")), React.createElement(View, {\n        style: styles.urgenceContainer,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 290,\n          columnNumber: 21\n        }\n      }, React.createElement(TouchableOpacity, {\n        onPress: function onPress() {\n          return _this2.callCovid();\n        },\n        style: styles.urgenceBtn,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 291,\n          columnNumber: 25\n        }\n      }, React.createElement(Image, {\n        source: require(\"../images/sos.png\"),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 292,\n          columnNumber: 29\n        }\n      })), React.createElement(Text, {\n        style: styles.legend,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 294,\n          columnNumber: 25\n        }\n      }, \"COVID-19\"))), React.createElement(View, {\n        style: styles.bottonTabMenu,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 300,\n          columnNumber: 17\n        }\n      }, datas.map(function (data, i) {\n        return _this2.renderBtn(data.index, data.uri, i);\n      })));\n      {}\n    }\n  }]);\n\n  return Emergency;\n}(Component);\n\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1\n  },\n  bottonTabMenu: {\n    flexDirection: \"row\",\n    justifyContent: \"space-around\",\n    alignItems: \"center\",\n    backgroundColor: \"white\",\n    padding: 10,\n    borderRadius: 50,\n    shadowColor: \"#000\",\n    shadowOffset: {\n      width: 0,\n      height: 2\n    },\n    shadowOpacity: 0.25,\n    shadowRadius: 3.84,\n    elevation: 5\n  },\n  active: {\n    backgroundColor: \"red\"\n  },\n  urgenceContainer: {\n    height: hp(\"65%\"),\n    backgroundColor: \"white\",\n    borderRadius: 50,\n    marginTop: hp(\"3%\"),\n    justifyContent: 'center',\n    alignItems: 'center'\n  },\n  legend: {\n    fontSize: 25,\n    fontWeight: \"800\",\n    textAlign: \"center\"\n  },\n  btn: {\n    justifyContent: 'center',\n    alignItems: 'center',\n    backgroundColor: \"red\"\n  }\n});\n\nvar mapStateToProps = function mapStateToProps(store) {\n  return {\n    user: store.user,\n    contact: store.contact\n  };\n};\n\nvar mapDispatchToProps = {};\nexport default connect(mapStateToProps, mapDispatchToProps)(Emergency);","map":{"version":3,"sources":["E:/Projets/Acadys/best4sante/SanteV2/assets/Screens/Emergency.js"],"names":["React","Component","AsyncStorage","connect","axios","TopMenu","TabBar","Permissions","Location","emergency","urgency","widthPercentageToDP","wp","heightPercentageToDP","hp","TouchableOpacity","Bdd","ViewPager","Avatar","getCurrentLocation","google","API_KEY","cloud_key","Emergency","props","componentDidMount","_getCountryCodeByLocation","sendmail","type","msg","location","data","typeUrgence","geolocUrgence","coords","latitude","longitude","idUser","user","post","api_url","then","res","console","log","_","callUrgence","findNumber","num","callPerson","ambulance","callAccident","fire","callAgression","police","callCovid","covid","urgence","length","Ambulance","All","Fire","Police","Covid","key","getItem","value","Alert","alert","text","onPress","askAsync","LOCATION","status","setState","errorMessage","getCurrentPositionAsync","setItem","get","response","globalRes","results","address_components","filter","el","types","includes","resObj","short_name","local","localCode","Country","ISOCode","catch","err","renderBtn","index","url","i","current","viewPager","setPage","state","phone","undefined","Platform","OS","Linking","canOpenURL","supported","openURL","datas","uri","require","styles","container","under_ios","under","navigation","flexGrow","marginTop","urgenceContainer","urgenceBtn","legend","bottonTabMenu","map","StyleSheet","create","flex","flexDirection","justifyContent","alignItems","backgroundColor","padding","borderRadius","shadowColor","shadowOffset","width","height","shadowOpacity","shadowRadius","elevation","active","fontSize","fontWeight","textAlign","btn","mapStateToProps","store","contact","mapDispatchToProps"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\r\nimport { Text, View, StyleSheet, Image, Linking, Alert, Button, AsyncStorage } from 'react-native'\r\nimport { connect } from 'react-redux'\r\nimport axios from 'axios'\r\nimport TopMenu from \"../component/Menu/TopMenu\"\r\nimport TabBar from \"@mindinventory/react-native-tab-bar-interaction\";\r\nimport * as Permissions from 'expo-permissions';\r\nimport * as Location from 'expo-location';\r\nimport { emergency } from \"../API/emergency\";\r\nimport { urgency } from \"../API/urgency\";\r\nimport {\r\n    widthPercentageToDP as wp,\r\n    heightPercentageToDP as hp,\r\n} from 'react-native-responsive-screen'\r\nimport { TouchableOpacity } from 'react-native-gesture-handler'\r\nimport Bdd from \"../API/Bdd\"\r\nimport ViewPager from '@react-native-community/viewpager';\r\nimport { Avatar } from 'react-native-elements';\r\nimport { getCurrentLocation } from '../services/location'\r\nimport google from \"../API/google\";\r\n\r\n\r\nconst API_KEY = google.cloud_key;\r\n\r\n\r\nclass Emergency extends Component {\r\n\r\n    constructor(props) {\r\n        super(props)\r\n        // this.state = {\r\n        //     localCode: \"\",\r\n        //     urgence: {}\r\n        // }\r\n        this.urgence = {}\r\n        this.localCode = \"\"\r\n\r\n        this.state = {\r\n            current: 1\r\n        }\r\n    }\r\n\r\n    componentDidMount = async () => {\r\n        await this._getCountryCodeByLocation()\r\n    }\r\n\r\n\r\n    sendmail = async (type, msg) => {\r\n\r\n        let location = await getCurrentLocation()\r\n\r\n\r\n        let data = {\r\n            typeUrgence: type,\r\n            geolocUrgence: `${location.coords.latitude},${location.coords.longitude}`,\r\n            idUser: this.props.user.user.idUser\r\n        }\r\n        let idUser = this.props.user.user.idUser\r\n\r\n\r\n\r\n        await axios.post(`${Bdd.api_url}/urgence`, data)\r\n            .then(async res => {\r\n                console.log(\"eto le izy \", res.data.data)\r\n            })\r\n\r\n        await axios.post(`${Bdd.api_url}/contact/inform/${idUser}`)\r\n            .then(async _ => {\r\n\r\n            })\r\n    }\r\n\r\n    callUrgence = async () => {\r\n        let num = await this.findNumber()\r\n        this.callPerson(num.ambulance)\r\n        await this.sendmail(\"Malaise\")\r\n    }\r\n    callAccident = async () => {\r\n        let num = await this.findNumber()\r\n        this.callPerson(num.fire)\r\n\r\n        await this.sendmail(\"Accident\")\r\n    }\r\n\r\n    callAgression = async () => {\r\n        let num = await this.findNumber()\r\n        this.callPerson(num.police)\r\n\r\n        await this.sendmail(\"Agression\")\r\n    }\r\n\r\n    callCovid = async () => {\r\n        let num = await this.findNumber()\r\n        this.callPerson(num.covid)\r\n\r\n        await this.sendmail(\"Covid\")\r\n\r\n    }\r\n\r\n    findNumber = async () => {\r\n\r\n\r\n        let num = {\r\n            ambulance: null,\r\n            fire: null,\r\n            police: null,\r\n            covid: null\r\n        }\r\n\r\n        if (this.urgence.length === 0) {\r\n            console.log('No urgence')\r\n        } else {\r\n            let urgence = this.urgence\r\n            console.log(\"urgence\", urgence)\r\n            num = {\r\n                ambulance: urgence[0].Ambulance.All[0],\r\n                fire: urgence[0].Fire.All[0],\r\n                police: urgence[0].Police.All[0],\r\n                covid: urgence[0].Covid.All[0]\r\n            }\r\n        }\r\n        console.log(num)\r\n        return num\r\n    }\r\n\r\n    callPerson(phone) {\r\n        console.log('Phone', phone)\r\n        if (phone === undefined || phone === null) {\r\n            Alert.alert(`Echec ${this.localCode}`, 'Pas de numero joignable', [{\r\n                text: 'OK',\r\n                onPress: () => { }\r\n            }])\r\n            return\r\n        } else {\r\n            let url;\r\n            if (Platform.OS === 'ios') {\r\n                url = 'tel://' + phone\r\n            }\r\n            else if (Platform.OS === 'android') {\r\n                url = 'tel:' + phone\r\n\r\n            }\r\n\r\n            Linking.canOpenURL(url)\r\n                .then((supported) => {\r\n                    if (supported) {\r\n                        return Linking.openURL(url)\r\n                            .catch(() => null);\r\n                    }\r\n                });\r\n        }\r\n    }\r\n\r\n\r\n    _getCountryCodeByLocation = async () => {\r\n\r\n        const key = 'permission_location';\r\n        const value = await AsyncStorage.getItem(key)\r\n\r\n        if (value === null) {\r\n            Alert.alert('Localisation',\r\n                'Nous demandons votre permission afin de récuperer votre localisation en référence avec les contacts d\\'urgences', [\r\n                {\r\n                    text: 'Suivant',\r\n                    onPress: async () => {\r\n                        let { status } = await Permissions.askAsync(Permissions.LOCATION);\r\n\r\n                        if (status !== 'granted') {\r\n                            this.setState({\r\n                                errorMessage: 'Permission to access location was denied',\r\n                            });\r\n                        } else {\r\n                            let location = await Location.getCurrentPositionAsync({});\r\n                            await AsyncStorage.setItem(key, 'OK');\r\n\r\n                            //    axios.get(\"https://maps.googleapis.com/maps/api/geocode/json?latlng=46.5286307,6.5124095&key=\" + API_KEY)\r\n\r\n                            axios.get(\"https://maps.googleapis.com/maps/api/geocode/json?latlng=\" + location.coords.latitude + \",\" + location.coords.longitude + \"&key=\" + API_KEY)\r\n                                .then(async response => {\r\n                                    const globalRes = response.data.results[0].address_components\r\n\r\n                                    let resObj = await globalRes.filter(el => {\r\n                                        return el.types.includes(\"country\")\r\n                                    })\r\n                                    const local = await resObj[0].short_name\r\n                                    this.localCode = local\r\n                                    console.log(\"Short name local :\", this.localCode)\r\n                                    let res = urgency.data.filter(el => {\r\n                                        return el.Country.ISOCode == local\r\n                                    })\r\n\r\n                                    //    this.setState({\r\n                                    //        urgence : res\r\n                                    //    })\r\n                                    this.urgence = res\r\n                                    console.log('Urgence ', this.urgence.length)\r\n\r\n                                })\r\n                                .catch(err => {\r\n                                    console.log(err)\r\n                                })\r\n                        }\r\n\r\n                    }\r\n                }\r\n            ])\r\n        } else {\r\n            let location = await Location.getCurrentPositionAsync({});\r\n            axios.get(\"https://maps.googleapis.com/maps/api/geocode/json?latlng=\" + location.coords.latitude + \",\" + location.coords.longitude + \"&key=\" + API_KEY)\r\n                .then(async response => {\r\n\r\n\r\n                    const globalRes = response.data.results[0].address_components\r\n\r\n                    let resObj = await globalRes.filter(el => {\r\n                        return el.types.includes(\"country\")\r\n                    })\r\n                    const local = await resObj[0].short_name\r\n                    this.localCode = local\r\n                    console.log(\"Short name local :\", this.localCode)\r\n                    let res = urgency.data.filter(el => {\r\n                        return el.Country.ISOCode == local\r\n                    })\r\n\r\n                    this.urgence = res\r\n                    console.log('Urgence ', this.urgence.length)\r\n\r\n                })\r\n                .catch(err => {\r\n                    console.log(err)\r\n                })\r\n        }\r\n\r\n    };\r\n\r\n    renderBtn = (index, url, i) => (\r\n        <TouchableOpacity key={i}\r\n            onPress={() => {\r\n                this.setState({ current: index })\r\n                this.viewPager.setPage(index)\r\n            }}>\r\n            {this.state.current !== index && <Avatar source={url} rounded size=\"medium\" />}\r\n            {this.state.current === index && <Avatar source={url} rounded size=\"large\" />}\r\n\r\n        </TouchableOpacity>\r\n    )\r\n    render() {\r\n\r\n        var datas = [{\r\n            index: 0, uri: require(\"../images/accident.png\")\r\n        }, {\r\n            index: 1, uri: require(\"../images/malaise.png\")\r\n        }, {\r\n            index: 2, uri: require(\"../images/agression.png\")\r\n        }, {\r\n            index: 3, uri: require(\"../images/cvo.jpg\")\r\n        }]\r\n\r\n        return (\r\n\r\n            <View style={styles.container}>\r\n                <View style={[Platform.OS === 'ios' ? styles.under_ios : styles.under]}>\r\n                    <TopMenu navigation={this.props.navigation} />\r\n                </View>\r\n                <ViewPager\r\n                    style={{ flexGrow: 1, marginTop: hp('15%') }}\r\n                    ref={viewPager => {\r\n                        this.viewPager = viewPager\r\n                    }}\r\n                >\r\n                    <View style={styles.urgenceContainer}>\r\n                        <TouchableOpacity\r\n                            onPress={() => this.callAccident()} style={styles.urgenceBtn}>\r\n                            <Image source={require(\"../images/sos.png\")} />\r\n                            <Text style={styles.legend}>ACCIDENT</Text>\r\n                        </TouchableOpacity>\r\n                    </View>\r\n                    <View style={styles.urgenceContainer}>\r\n                        <TouchableOpacity onPress={() => this.callUrgence()} style={styles.urgenceBtn}>\r\n                            <Image source={require(\"../images/sos.png\")} />\r\n                        </TouchableOpacity>\r\n                        <Text style={styles.legend}>MALAISE</Text>\r\n                    </View>\r\n                    <View style={styles.urgenceContainer}>\r\n                        <TouchableOpacity onPress={() => this.callAgression()} style={styles.urgenceBtn}>\r\n                            <Image source={require(\"../images/sos.png\")} />\r\n                        </TouchableOpacity>\r\n                        <Text style={styles.legend}>AGRESSION</Text>\r\n\r\n                    </View>\r\n                    <View style={styles.urgenceContainer}>\r\n                        <TouchableOpacity onPress={() => this.callCovid()} style={styles.urgenceBtn}>\r\n                            <Image source={require(\"../images/sos.png\")} />\r\n                        </TouchableOpacity>\r\n                        <Text style={styles.legend}>COVID-19</Text>\r\n\r\n                    </View>\r\n\r\n                </ViewPager>\r\n\r\n                <View style={styles.bottonTabMenu}>\r\n                    {datas.map((data, i) => {\r\n                        return this.renderBtn(data.index, data.uri, i)\r\n                    })}\r\n                </View>\r\n\r\n            </View>)\r\n\r\n        {/* <TabBar bgNavBar=\"white\" bgNavBarSelector=\"white\" stroke=\"skyblue\">\r\n\r\n                <TabBar.Item\r\n\r\n                    icon={require(`../images/accident.png`)}\r\n                    selectedIcon={require(`../images/accident.png`)}\r\n                    title=\"Tab1\"\r\n                    screenBackgroundColor={{ backgroundColor: '#00C1B4' }}\r\n                >\r\n                    <View>\r\n                        <View style={Platform.OS === 'ios' ? styles.under_ios : styles.under}>\r\n                            <TopMenu navigation={this.props.navigation} />\r\n                        </View>\r\n                        <View style={styles.urgenceContainer}>\r\n                            <TouchableOpacity onPress={()=> this.callAccident()} style={styles.urgenceBtn}>\r\n                                <Image source={require(\"../images/sos.png\")} />\r\n                                <Text  style={styles.legend}>ACCIDENT</Text>\r\n                            </TouchableOpacity>\r\n                            <Button  color={\"red\"} title=\"Covid 19\" style={styles.btn} onPress={()=> this.callCovid()}></Button>\r\n                        </View>\r\n                    </View>\r\n                </TabBar.Item>\r\n\r\n                <TabBar.Item\r\n\r\n                    icon={require(`../images/malaise.png`)}\r\n                    selectedIcon={require(`../images/malaise.png`)}\r\n                    title=\"Tab1\"\r\n                    screenBackgroundColor={{ backgroundColor: '#00C1B4' }}\r\n                >\r\n                    <View style=\"emergencyContainer\">\r\n                        <View style={Platform.OS === 'ios' ? styles.under_ios : styles.under}>\r\n                            <TopMenu navigation={this.props.navigation} />\r\n                        </View>\r\n                        <View style={styles.urgenceContainer}>\r\n                            <TouchableOpacity onPress={()=> this.callUrgence()} style={styles.urgenceBtn}>\r\n                            <Image source={require(\"../images/sos.png\")} />\r\n                            </TouchableOpacity>\r\n                            <Text  style={styles.legend}>MALAISE</Text>\r\n                            <Button  color={\"red\"} title=\"Covid 19\" onPress={()=> this.callCovid()}></Button>\r\n                        </View>\r\n                        \r\n                    </View>\r\n                </TabBar.Item>\r\n\r\n                <TabBar.Item\r\n\r\n                    icon={require(`../images/agression.png`)}\r\n                    selectedIcon={require(`../images/agression.png`)}\r\n                    title=\"Tab1\"\r\n                    screenBackgroundColor={{ backgroundColor: '#00C1B4' }}\r\n                >\r\n                    <View>\r\n                        <View style={Platform.OS === 'ios' ? styles.under_ios : styles.under}>\r\n                            <TopMenu navigation={this.props.navigation} />\r\n                        </View>\r\n                        <View style={styles.urgenceContainer}>\r\n                        <TouchableOpacity onPress={()=> this.callAgression()} style={styles.urgenceBtn}>\r\n                            <Image source={require(\"../images/sos.png\")} />\r\n                            </TouchableOpacity>\r\n                            <Text  style={styles.legend}>AGRESSION</Text>\r\n                            \r\n                            <Button  color={\"red\"} title=\"Covid 19\" onPress={()=> this.callCovid()}></Button>\r\n                        </View>\r\n                    </View>\r\n                </TabBar.Item>\r\n            </TabBar> */}\r\n\r\n\r\n\r\n    }\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n    container: {\r\n        flex: 1\r\n    },\r\n    bottonTabMenu: {\r\n        flexDirection: \"row\",\r\n        justifyContent: \"space-around\",\r\n        alignItems: \"center\",\r\n        backgroundColor: \"white\",\r\n        padding: 10,\r\n        borderRadius: 50,\r\n        shadowColor: \"#000\",\r\n        shadowOffset: {\r\n            width: 0,\r\n            height: 2\r\n        },\r\n        shadowOpacity: 0.25,\r\n        shadowRadius: 3.84,\r\n        elevation: 5\r\n    },\r\n    active: {\r\n        backgroundColor: \"red\"\r\n    },\r\n    urgenceContainer: {\r\n        height: hp(\"65%\"),\r\n        backgroundColor: \"white\",\r\n        borderRadius: 50,\r\n        marginTop: hp(\"3%\"),\r\n        justifyContent: 'center',\r\n        alignItems: 'center'\r\n    },\r\n    legend: {\r\n        fontSize: 25,\r\n        fontWeight: \"800\",\r\n        textAlign: \"center\"\r\n    },\r\n    btn: {\r\n        justifyContent: 'center',\r\n        alignItems: 'center',\r\n        backgroundColor: \"red\"\r\n    }\r\n})\r\n\r\nconst mapStateToProps = (store) => {\r\n    return {\r\n        user: store.user,\r\n        contact: store.contact\r\n    }\r\n}\r\n\r\nconst mapDispatchToProps = {\r\n\r\n}\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Emergency)\r\n\r\n"]},"metadata":{},"sourceType":"module"}