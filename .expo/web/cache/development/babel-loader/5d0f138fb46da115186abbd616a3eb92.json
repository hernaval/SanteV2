{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nvar _jsxFileName = \"E:\\\\Projets\\\\Acadys\\\\best4sante\\\\SanteV2\\\\assets\\\\Screens\\\\Settings\\\\Signal.js\";\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React, { Component } from 'react';\nimport Text from \"react-native-web/dist/exports/Text\";\nimport View from \"react-native-web/dist/exports/View\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport ScrollView from \"react-native-web/dist/exports/ScrollView\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport { connect } from 'react-redux';\nimport Loader from \"../../component/loader\";\nimport { widthPercentageToDP as wp, heightPercentageToDP as hp } from 'react-native-responsive-screen';\nimport HeaderMenu from \"../../component/Menu/HeaderMenu\";\nimport { TextInput } from 'react-native-paper';\nimport Axios from 'axios';\nimport Bdd from \"../../API/Bdd\";\nimport { GiftedChat, Send, Bubble } from 'react-native-gifted-chat';\nimport { IconButton } from 'react-native-paper';\nimport { Avatar } from 'react-native-elements';\nimport { FontAwesomeIcon } from '@fortawesome/react-native-fontawesome';\nimport { faChevronRight } from '@fortawesome/free-solid-svg-icons';\n\nvar Signal = function (_Component) {\n  _inherits(Signal, _Component);\n\n  var _super = _createSuper(Signal);\n\n  function Signal() {\n    var _this;\n\n    _classCallCheck(this, Signal);\n\n    _this = _super.call(this);\n\n    _this.getAndConstructMessage = function _callee2() {\n      return _regeneratorRuntime.async(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return _regeneratorRuntime.awrap(Axios.get(\"http://adequa.club:3000/api-backoffice/user/signal/mysignal?idUser=\" + _this.props.user.user.idUser).then(function _callee(res) {\n                var msg;\n                return _regeneratorRuntime.async(function _callee$(_context) {\n                  while (1) {\n                    switch (_context.prev = _context.next) {\n                      case 0:\n                        msg = [];\n                        res.data.forEach(function (el) {\n                          var data = {\n                            _id: Math.random(),\n                            text: el.descriSignal,\n                            createdAt: new Date(el.createdAt).getTime(),\n                            user: {\n                              _id: 1,\n                              name: el.user.nomUser\n                            }\n                          };\n                          msg.push(data);\n                        });\n\n                        _this.state.messages.forEach(function (el) {\n                          msg.push(el);\n                        });\n\n                        _this.setState({\n                          messages: msg\n                        });\n\n                      case 4:\n                      case \"end\":\n                        return _context.stop();\n                    }\n                  }\n                }, null, null, null, Promise);\n              }).catch(function (err) {\n                console.log(err);\n              }));\n\n            case 2:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    };\n\n    _this.sendSignal = function _callee4(message) {\n      var data;\n      return _regeneratorRuntime.async(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              console.log(message);\n              data = {\n                sujetSignal: \"Demande\",\n                descriSignal: message.text,\n                idUser: _this.props.user.user.idUser\n              };\n              _context4.next = 4;\n              return _regeneratorRuntime.awrap(Axios.post(Bdd.api_url + \"/signal\", data).then(function _callee3(res) {\n                return _regeneratorRuntime.async(function _callee3$(_context3) {\n                  while (1) {\n                    switch (_context3.prev = _context3.next) {\n                      case 0:\n                        console.log(res.data);\n\n                      case 1:\n                      case \"end\":\n                        return _context3.stop();\n                    }\n                  }\n                }, null, null, null, Promise);\n              }).catch(function (err) {\n                console.log(err);\n\n                _this.setState({\n                  isLoading: false\n                });\n              }));\n\n            case 4:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    };\n\n    _this.handleSend = function () {\n      var newMessage = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n\n      _this.setState({\n        messages: GiftedChat.append(_this.state.messages, newMessage)\n      });\n\n      _this.sendSignal(newMessage[0]);\n    };\n\n    _this.state = {\n      isLoading: false,\n      messages: [{\n        _id: 0,\n        text: 'Nouvelle discussion créée',\n        createdAt: new Date().getTime(),\n        system: true\n      }, {\n        _id: 1,\n        text: \"Bonjour, l'équipe Best4Santé est à votre écoute. Laissez votre message et notre équipe reviendra vers vous le plus vite possible\",\n        createdAt: new Date().getTime(),\n        user: {\n          _id: 2,\n          name: 'Admin'\n        }\n      }]\n    };\n    _this.sujet = \"\", _this.description = \"\";\n    return _this;\n  }\n\n  _createClass(Signal, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      return _regeneratorRuntime.async(function componentDidMount$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n              this.setState({\n                isLoading: true\n              });\n              _context5.next = 3;\n              return _regeneratorRuntime.awrap(this.getAndConstructMessage());\n\n            case 3:\n              this.setState({\n                isLoading: false\n              });\n\n            case 4:\n            case \"end\":\n              return _context5.stop();\n          }\n        }\n      }, null, this, null, Promise);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      return React.createElement(View, {\n        style: styles.container,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 123,\n          columnNumber: 13\n        }\n      }, this.state.isLoading && React.createElement(View, {\n        style: styles.loading_container,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 124,\n          columnNumber: 34\n        }\n      }, React.createElement(Loader, {\n        loading: this.state.isLoading,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 125,\n          columnNumber: 10\n        }\n      })), React.createElement(View, {\n        style: [Platform.OS === 'ios' ? styles.under_ios : styles.under, {\n          marginBottom: 20\n        }],\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 128,\n          columnNumber: 9\n        }\n      }, React.createElement(HeaderMenu, {\n        navigation: this.props.navigation,\n        signaler: 1,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 129,\n          columnNumber: 21\n        }\n      })), React.createElement(GiftedChat, {\n        placeholder: \"Tapez vos remarques ici...\",\n        messages: this.state.messages,\n        onSend: function onSend(newMessage) {\n          return _this2.handleSend(newMessage);\n        },\n        user: {\n          _id: 1\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 133,\n          columnNumber: 9\n        }\n      }));\n    }\n  }]);\n\n  return Signal;\n}(Component);\n\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    justifyContent: \"center\",\n    backgroundColor: 'white'\n  },\n  under: {\n    flex: 1,\n    maxHeight: hp('10%')\n  },\n  header: {\n    textAlign: 'center'\n  },\n  center: {\n    textAlign: 'center',\n    color: \"white\",\n    fontSize: 21,\n    marginTop: hp('10%')\n  },\n  red: {\n    color: 'red'\n  },\n  body: {\n    flex: 1,\n    backgroundColor: '#fff',\n    alignItems: 'center',\n    justifyContent: 'center'\n  },\n  textinput: {\n    marginLeft: 5,\n    marginRight: 5,\n    height: 50,\n    width: wp(\"70%\"),\n    paddingLeft: 15,\n    backgroundColor: 'white',\n    borderRadius: 1,\n    marginBottom: hp('2%')\n  },\n  footer: {\n    textAlign: 'center',\n    textDecorationLine: 'underline',\n    paddingTop: 15,\n    paddingBottom: 15,\n    paddingLeft: 15,\n    paddingRight: 15,\n    color: \"white\"\n  },\n  normalText: {\n    color: \"white\"\n  },\n  title2: {\n    color: \"white\",\n    marginBottom: hp('2%'),\n    marginTop: hp('5%'),\n    textAlign: \"center\"\n  },\n  buttonStyle: {\n    width: wp(\"70%\"),\n    backgroundColor: \"#00C1B4\",\n    paddingTop: hp('2%'),\n    paddingBottom: hp('2%'),\n    borderRadius: 10,\n    marginBottom: hp(\"2%\"),\n    borderWidth: 1,\n    borderRadius: 2,\n    borderColor: '#029B95',\n    borderTopWidth: 0,\n    borderLeftWidth: 0,\n    shadowColor: '#000',\n    shadowOffset: {\n      width: 0,\n      height: 2\n    },\n    shadowOpacity: 0.8,\n    shadowRadius: 2,\n    elevation: 1\n  },\n  buttonText: {\n    color: 'white',\n    textAlign: \"center\",\n    fontSize: 16\n  },\n  loading_container: {\n    position: 'absolute',\n    zIndex: 10,\n    left: 0,\n    right: 0,\n    top: 100,\n    bottom: 0,\n    alignItems: 'center',\n    justifyContent: 'center'\n  },\n  textDescriContainer: {\n    marginTop: hp(\"5%\")\n  },\n  textDescri: {\n    textAlign: \"center\",\n    fontSize: 14\n  }\n});\n\nvar mapStateToProps = function mapStateToProps(store) {\n  return {\n    user: store.user\n  };\n};\n\nvar mapDispatchToProps = {};\nexport default connect(mapStateToProps, mapDispatchToProps)(Signal);","map":{"version":3,"sources":["E:/Projets/Acadys/best4sante/SanteV2/assets/Screens/Settings/Signal.js"],"names":["React","Component","connect","Loader","widthPercentageToDP","wp","heightPercentageToDP","hp","HeaderMenu","TextInput","Axios","Bdd","GiftedChat","Send","Bubble","IconButton","Avatar","FontAwesomeIcon","faChevronRight","Signal","getAndConstructMessage","get","props","user","idUser","then","res","msg","data","forEach","el","_id","Math","random","text","descriSignal","createdAt","Date","getTime","name","nomUser","push","state","messages","setState","catch","err","console","log","sendSignal","message","sujetSignal","post","api_url","isLoading","handleSend","newMessage","append","system","sujet","description","styles","container","loading_container","Platform","OS","under_ios","under","marginBottom","navigation","StyleSheet","create","flex","justifyContent","backgroundColor","maxHeight","header","textAlign","center","color","fontSize","marginTop","red","body","alignItems","textinput","marginLeft","marginRight","height","width","paddingLeft","borderRadius","footer","textDecorationLine","paddingTop","paddingBottom","paddingRight","normalText","title2","buttonStyle","borderWidth","borderColor","borderTopWidth","borderLeftWidth","shadowColor","shadowOffset","shadowOpacity","shadowRadius","elevation","buttonText","position","zIndex","left","right","top","bottom","textDescriContainer","textDescri","mapStateToProps","store","mapDispatchToProps"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\r\nimport { Text, View, TouchableOpacity,StyleSheet ,ScrollView ,Image} from 'react-native'\r\nimport { connect } from 'react-redux'\r\nimport Loader from '../../component/loader'\r\nimport {\r\n    widthPercentageToDP as wp,\r\n    heightPercentageToDP as hp,\r\n} from 'react-native-responsive-screen'\r\nimport HeaderMenu from '../../component/Menu/HeaderMenu'\r\nimport { TextInput } from 'react-native-paper';\r\nimport Axios from 'axios'\r\nimport Bdd from '../../API/Bdd'\r\nimport { GiftedChat,Send,Bubble } from 'react-native-gifted-chat';\r\nimport { IconButton } from 'react-native-paper';\r\nimport { Avatar } from 'react-native-elements'\r\nimport { FontAwesomeIcon } from '@fortawesome/react-native-fontawesome';\r\nimport { faChevronRight } from '@fortawesome/free-solid-svg-icons';\r\n\r\n\r\nclass Signal extends Component {\r\n\r\n    constructor(){\r\n        super()\r\n        this.state = {\r\n            isLoading :false,\r\n            messages : [\r\n              /**\r\n               * Mock message data\r\n               */\r\n              // example of system message\r\n              {\r\n                _id: 0,\r\n                text: 'Nouvelle discussion créée',\r\n                createdAt: new Date().getTime(),\r\n                system: true\r\n              },\r\n              // example of chat message\r\n              {\r\n                _id: 1,\r\n                text: \"Bonjour, l'équipe Best4Santé est à votre écoute. Laissez votre message et notre équipe reviendra vers vous le plus vite possible\",\r\n                createdAt: new Date().getTime(),\r\n                user: {\r\n                  _id: 2,\r\n                  name: 'Admin'\r\n                },\r\n\r\n                \r\n              },\r\n\r\n            \r\n            ]\r\n        }\r\n        this.sujet = \"\",\r\n        this.description = \"\"\r\n    }\r\n\r\n    async componentDidMount(){\r\n      this.setState({isLoading : true})\r\n      await this.getAndConstructMessage()\r\n      this.setState({isLoading : false})\r\n    }\r\n\r\n    getAndConstructMessage = async() =>{\r\n      \r\n      await Axios.get(`http://adequa.club:3000/api-backoffice/user/signal/mysignal?idUser=${this.props.user.user.idUser}`)\r\n          .then(async res =>{\r\n            \r\n           let msg = []\r\n            res.data.forEach(el=>{\r\n              let data ={\r\n                _id: Math.random(),\r\n                text: el.descriSignal,\r\n                createdAt: new Date(el.createdAt).getTime(),\r\n                user: {\r\n                  _id: 1,\r\n                  name: el.user.nomUser\r\n                }\r\n              }\r\n\r\n              msg.push(data)\r\n            })\r\n           \r\n           this.state.messages.forEach(el=>{\r\n             msg.push(el)\r\n           })\r\n            this.setState({messages : msg})\r\n          })\r\n          .catch(err=>{\r\n            console.log(err)\r\n          })\r\n    }\r\n\r\n    sendSignal = async (message) =>{\r\n      console.log(message)\r\n       \r\n        let data = {\r\n            sujetSignal : \"Demande\",\r\n            descriSignal : message.text,\r\n            idUser : this.props.user.user.idUser\r\n        }\r\n        await Axios.post(`${Bdd.api_url}/signal`,data)\r\n            .then(async res=>{\r\n                console.log(res.data)\r\n            })\r\n            .catch(err=>{\r\n                console.log(err)\r\n                this.setState({isLoading : false})\r\n            })\r\n        \r\n    }\r\n\r\n     handleSend = (newMessage = []) =>{\r\n      \r\n      this.setState({\r\n        messages: GiftedChat.append(this.state.messages, newMessage)\r\n      })\r\n\r\n      this.sendSignal(newMessage[0])\r\n    \r\n    }\r\n    render() {\r\n        return (\r\n            <View style={styles.container}>\r\n        {this.state.isLoading && <View style={styles.loading_container}>\r\n         <Loader loading={this.state.isLoading} />\r\n        </View>}\r\n\r\n        <View style={[Platform.OS === 'ios' ? styles.under_ios : styles.under, {marginBottom : 20}]}>\r\n                    <HeaderMenu navigation={this.props.navigation} signaler={1} />\r\n        </View>\r\n\r\n       \r\n        <GiftedChat\r\n      \r\n        placeholder={\"Tapez vos remarques ici...\"}\r\n      messages={this.state.messages}\r\n      onSend={newMessage => this.handleSend(newMessage)}\r\n      user={{ _id: 1 }}\r\n     \r\n      />\r\n        \r\n        \r\n\r\n      \r\n\r\n       \r\n        {/* <View style={styles.textDescriContainer}>\r\n            <Text style={styles.textDescri}>Si vous avez quelques choses à signaler auprès de l'admin BEST4SANTE, \r\n                laissez votre  message ici. Vous allez être notifié dès qu'un admin reçoit votre demande.\r\n            </Text>\r\n        </View>\r\n\r\n        <View style={{ flex: 1, justifyContent: \"center\", marginLeft: 20, marginRight: 20}} >\r\n\r\n          <TextInput\r\n            style={{ marginBottom: 20, backgroundColor : \"white\" }}\r\n            onChangeText={(text) => this.sujet = text}\r\n            label=\"SUJET\"\r\n\r\n          />\r\n          <TextInput\r\n            style={{ marginBottom: 20, backgroundColor : \"white\" }}\r\n            onChangeText={(text) => this.description = text}\r\n            label=\"Description\"\r\n            multiline\r\n          />\r\n         \r\n\r\n        </View>\r\n\r\n\r\n        <View style={{marginVertical : hp(\"2%\"),marginHorizontal : wp(\"2%\")}}>\r\n          <TouchableOpacity onPress={()=> this.sendSignal()} style={{padding : 20, backgroundColor : \"#00C1B4\"}}>\r\n            <Text style={{textAlign : \"center\",color :\"white\"}}>Valider</Text>\r\n          </TouchableOpacity>\r\n        </View>\r\n */}\r\n      </View>\r\n        )\r\n    }\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n    container: {\r\n      flex: 1,\r\n      justifyContent: \"center\",\r\n     \r\n       backgroundColor: 'white'\r\n    },\r\n    under: {\r\n      flex: 1,\r\n      maxHeight: hp('10%'),\r\n    },\r\n    header: {\r\n  \r\n      textAlign: 'center'\r\n    },\r\n    center: {\r\n      textAlign: 'center',\r\n      color: \"white\",\r\n      fontSize: 21,\r\n      marginTop: hp('10%')\r\n    },\r\n    red: {\r\n      color: 'red'\r\n    },\r\n    body: {\r\n      flex: 1,\r\n      backgroundColor: '#fff',\r\n      alignItems: 'center',\r\n      justifyContent: 'center',\r\n    },\r\n    textinput: {\r\n      marginLeft: 5,\r\n      marginRight: 5,\r\n      height: 50,\r\n      width: wp(\"70%\"),\r\n      paddingLeft: 15,\r\n      backgroundColor: 'white',\r\n      borderRadius: 1,\r\n      marginBottom: hp('2%')\r\n    },\r\n    footer: {\r\n  \r\n      textAlign: 'center',\r\n      textDecorationLine: 'underline',\r\n      paddingTop: 15,\r\n      paddingBottom: 15,\r\n      paddingLeft: 15,\r\n      paddingRight: 15,\r\n      color: \"white\"\r\n    },\r\n    normalText: {\r\n      color: \"white\"\r\n    },\r\n    title2: {\r\n      color: \"white\",\r\n      marginBottom: hp('2%'),\r\n      marginTop: hp('5%'),\r\n      textAlign: \"center\"\r\n    },\r\n    buttonStyle: {\r\n  \r\n      width: wp(\"70%\"),\r\n  \r\n      backgroundColor: \"#00C1B4\",\r\n      paddingTop: hp('2%'),\r\n      paddingBottom: hp('2%'),\r\n      borderRadius: 10,\r\n      marginBottom: hp(\"2%\"),\r\n      borderWidth: 1,\r\n      borderRadius: 2,\r\n      borderColor: '#029B95',\r\n      borderTopWidth: 0,\r\n      borderLeftWidth: 0,\r\n      shadowColor: '#000',\r\n      shadowOffset: { width: 0, height: 2 },\r\n      shadowOpacity: 0.8,\r\n      shadowRadius: 2,\r\n      elevation: 1,\r\n    },\r\n    buttonText: {\r\n      color: 'white',\r\n      textAlign: \"center\",\r\n      fontSize: 16\r\n    },\r\n    loading_container: {\r\n      position: 'absolute',\r\n      zIndex: 10,\r\n      left: 0,\r\n      right: 0,\r\n      top: 100,\r\n      bottom: 0,\r\n      alignItems: 'center',\r\n      justifyContent: 'center'\r\n    },\r\n\r\n    textDescriContainer : {\r\n        marginTop : hp(\"5%\")\r\n    },\r\n    textDescri : {\r\n        textAlign : \"center\",\r\n        fontSize : 14\r\n    }\r\n\r\n  });\r\n  \r\n\r\n\r\nconst mapStateToProps = (store) => {\r\n    return {\r\n        user: store.user,\r\n    }\r\n}\r\nconst mapDispatchToProps = {\r\n   \r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Signal)\r\n"]},"metadata":{},"sourceType":"module"}