{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nvar _jsxFileName = \"E:\\\\Projets\\\\Acadys\\\\best4sante\\\\SanteV2\\\\assets\\\\component\\\\Urgence.js\";\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React from 'react';\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport View from \"react-native-web/dist/exports/View\";\nimport { AsyncStorage } from \"react-native-web/dist/index\";\nimport Linking from \"react-native-web/dist/exports/Linking\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport { Button } from 'react-native-elements';\nimport { withNavigation } from 'react-navigation';\nimport { connect } from 'react-redux';\nimport * as Permissions from 'expo-permissions';\nimport * as Location from 'expo-location';\nimport { widthPercentageToDP as wp, heightPercentageToDP as hp } from 'react-native-responsive-screen';\nimport Footer from \"./Menu/Footer\";\nimport axios from 'axios';\nimport Bdd from \"../API/Bdd\";\nimport Header from \"./Menu/Header\";\nimport TopMenu from \"./Menu/TopMenu\";\nimport BottomMenu from \"./Menu/BottomMenu\";\nimport { ScrollView } from 'react-native-gesture-handler';\nimport { emergency } from \"../API/emergency\";\nvar API_KEY = 'AIzaSyApjuz39FHMGBsy9lo7FobJQJtZKNra8P8';\n\nvar Urgence = function (_React$Component) {\n  _inherits(Urgence, _React$Component);\n\n  var _super = _createSuper(Urgence);\n\n  function Urgence() {\n    var _this;\n\n    _classCallCheck(this, Urgence);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, [this].concat(args));\n\n    _this.findNum = function _callee() {\n      var code;\n      return _regeneratorRuntime.async(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return _regeneratorRuntime.awrap(_this._getCountryCodeByLocation());\n\n            case 2:\n              code = _context.sent;\n              console.log(code);\n\n            case 4:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    };\n\n    _this._getCountryCodeByLocation = function _callee3() {\n      var _await$Permissions$as, status, location, code;\n\n      return _regeneratorRuntime.async(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              _context3.next = 2;\n              return _regeneratorRuntime.awrap(Permissions.askAsync(Permissions.LOCATION));\n\n            case 2:\n              _await$Permissions$as = _context3.sent;\n              status = _await$Permissions$as.status;\n\n              if (status !== 'granted') {\n                _this.setState({\n                  errorMessage: 'Permission to access location was denied'\n                });\n              }\n\n              _context3.next = 7;\n              return _regeneratorRuntime.awrap(Location.getCurrentPositionAsync({}));\n\n            case 7:\n              location = _context3.sent;\n              code = \"\";\n              _context3.next = 11;\n              return _regeneratorRuntime.awrap(axios.get(\"https://maps.googleapis.com/maps/api/geocode/json?latlng=\" + location.coords.latitude + \",\" + location.coords.longitude + \"&key=\" + API_KEY).then(function _callee2(response) {\n                var globalRes, resObj;\n                return _regeneratorRuntime.async(function _callee2$(_context2) {\n                  while (1) {\n                    switch (_context2.prev = _context2.next) {\n                      case 0:\n                        globalRes = response.data.results[0].address_components;\n                        _context2.next = 3;\n                        return _regeneratorRuntime.awrap(globalRes.filter(function (el) {\n                          return el.types.includes(\"country\");\n                        }));\n\n                      case 3:\n                        resObj = _context2.sent;\n                        console.log(resObj.short_name);\n                        code = resObj.short_name;\n\n                      case 6:\n                      case \"end\":\n                        return _context2.stop();\n                    }\n                  }\n                }, null, null, null, Promise);\n              }));\n\n            case 11:\n              return _context3.abrupt(\"return\", code);\n\n            case 12:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    };\n\n    return _this;\n  }\n\n  _createClass(Urgence, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var res = emergency.data[0];\n      console.log(this.findNum());\n    }\n  }, {\n    key: \"onCLickUrgence\",\n    value: function onCLickUrgence(type, msg) {\n      console.log(this.props.user.user.data.user[0].id);\n      var data = {\n        user_id: this.props.user.user.data.user[0].id\n      };\n      axios.post(Bdd.api_url + '/api/contact/all', data).then(function (res) {\n        console.log('res', res.data);\n        var contacts = res.data.contacts;\n        contacts.map(function (contact) {\n          var user = {\n            email: contact.email\n          };\n          axios.post(Bdd.api_url + '/api/user/byMail', user).then(function (user) {\n            console.log('response par email', user);\n\n            if (user.data.user.length !== 0) {\n              var mail = {\n                email: user.data.user[0].email,\n                msg: msg,\n                type: type\n              };\n              axios.post(Bdd.api_url + '/api/com/sendMail', mail).then(function (response) {\n                console.log(response);\n              }).catch(function (err) {\n                console.log('err', err);\n              });\n              var uuid = {\n                token: user.data.user[0].uuid,\n                msg: msg\n              };\n              axios.post(Bdd.api_url + '/api/com/notif', uuid).then(function (response) {\n                console.log(response);\n              }).catch(function (err) {\n                console.log('err', err);\n              });\n            }\n          }).catch(function (err) {\n            console.log('err', err);\n          });\n        });\n      }).catch(function (err) {\n        console.log('err', err);\n      });\n    }\n  }, {\n    key: \"callPerson\",\n    value: function callPerson(phone) {\n      var url;\n\n      if (Platform.OS === 'ios') {\n        url = 'tel://' + phone;\n      } else if (Platform.OS === 'android') {\n        url = 'tel:' + phone;\n      }\n\n      Linking.canOpenURL(url).then(function (supported) {\n        if (supported) {\n          return Linking.openURL(url).catch(function () {\n            return null;\n          });\n        }\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      return React.createElement(View, {\n        style: styles.container,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 150,\n          columnNumber: 7\n        }\n      }, React.createElement(View, {\n        style: Platform.OS === 'ios' ? styles.under_ios : styles.under,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 151,\n          columnNumber: 9\n        }\n      }, React.createElement(TopMenu, {\n        navigation: this.props.navigation,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 152,\n          columnNumber: 11\n        }\n      })), React.createElement(ScrollView, {\n        style: styles.main,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 154,\n          columnNumber: 9\n        }\n      }, React.createElement(Text, {\n        style: styles.title1,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 155,\n          columnNumber: 11\n        }\n      }, \"APPEL D'URGENCE\"), React.createElement(TouchableOpacity, {\n        style: styles.buttonStyle,\n        onPress: function onPress(e) {\n          _this2.onCLickUrgence('Accident', \"Attention accident, votre contact d'urgence a déclenché son bouton\");\n\n          _this2.callPerson('18');\n        },\n        title: \"Accident\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 156,\n          columnNumber: 11\n        }\n      }, React.createElement(Image, {\n        style: {\n          width: wp('15%'),\n          height: wp('15%'),\n          marginTop: hp('1%')\n        },\n        source: require(\"../images/accident.png\"),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 164,\n          columnNumber: 13\n        }\n      }), React.createElement(Text, {\n        style: styles.buttonText,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 168,\n          columnNumber: 13\n        }\n      }, \"ACCIDENT\")), React.createElement(TouchableOpacity, {\n        style: styles.buttonStyle,\n        onPress: function onPress(e) {\n          _this2.onCLickUrgence('Malaise', \"Attention malaise, votre contact d'urgence a déclenché son bouton\");\n\n          _this2.callPerson('15');\n        },\n        title: \"Malaise\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 169,\n          columnNumber: 11\n        }\n      }, React.createElement(Image, {\n        style: {\n          width: wp('15%'),\n          height: wp('15%'),\n          marginTop: hp('1%')\n        },\n        source: require(\"../images/malaise.png\"),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 177,\n          columnNumber: 13\n        }\n      }), React.createElement(Text, {\n        style: styles.buttonText,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 181,\n          columnNumber: 13\n        }\n      }, \"MALAISE\")), React.createElement(TouchableOpacity, {\n        style: styles.buttonStyle,\n        onPress: function onPress(e) {\n          _this2.onCLickUrgence('Agression', \"Attention agression, votre contact d'urgence a déclenché son bouton\");\n\n          _this2.callPerson('17');\n        },\n        title: \"Agression\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 183,\n          columnNumber: 11\n        }\n      }, React.createElement(Image, {\n        style: {\n          width: wp('15%'),\n          height: wp('15%'),\n          marginTop: hp('1%')\n        },\n        source: require(\"../images/agression.png\"),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 191,\n          columnNumber: 13\n        }\n      }), React.createElement(Text, {\n        style: styles.buttonText,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 195,\n          columnNumber: 13\n        }\n      }, \"AGRESSION\")), React.createElement(TouchableOpacity, {\n        style: styles.buttonStyle,\n        onPress: function onPress(e) {\n          _this2.onCLickUrgence('Agression', \"Attention agression, votre contact d'urgence a déclenché son bouton\");\n\n          _this2.callPerson('0651508656');\n        },\n        title: \"Agression\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 196,\n          columnNumber: 11\n        }\n      }, React.createElement(Image, {\n        style: {\n          width: wp('15%'),\n          height: wp('15%'),\n          marginTop: hp('1%')\n        },\n        source: require(\"../images/Detresse.png\"),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 204,\n          columnNumber: 13\n        }\n      }), React.createElement(Text, {\n        style: styles.buttonText,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 208,\n          columnNumber: 13\n        }\n      }, \"DETRESSE\"))), React.createElement(View, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 210,\n          columnNumber: 9\n        }\n      }, React.createElement(BottomMenu, {\n        navigation: this.props.navigation,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 211,\n          columnNumber: 11\n        }\n      })));\n    }\n  }]);\n\n  return Urgence;\n}(React.Component);\n\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: '#00C1B4',\n    alignItems: 'center',\n    justifyContent: 'center'\n  },\n  main: {\n    height: hp('70%'),\n    marginTop: hp('3%')\n  },\n  footer: {\n    height: hp(\"10%\")\n  },\n  buttonStyle: {\n    marginTop: hp(\"2%\"),\n    width: wp(\"70%\"),\n    backgroundColor: \"white\",\n    paddingBottom: hp('2%'),\n    borderBottomColor: \"#008AC8\",\n    borderBottomWidth: 6,\n    alignItems: \"center\"\n  },\n  buttonText: {\n    color: '#00C1B4',\n    textAlign: \"center\",\n    fontSize: 16,\n    fontWeight: \"bold\"\n  },\n  title1: {\n    fontSize: 30,\n    color: \"white\",\n    marginBottom: hp('3%'),\n    fontWeight: \"bold\"\n  },\n  under: {\n    height: hp('10%'),\n    width: wp(\"100%\"),\n    zIndex: 99\n  }\n});\n\nvar mapStateToProps = function mapStateToProps(store) {\n  return {\n    user: store.user,\n    contact: store.contact\n  };\n};\n\nvar mapDispatchToProps = {};\nexport default connect(mapStateToProps)(Urgence);","map":{"version":3,"sources":["E:/Projets/Acadys/best4sante/SanteV2/assets/component/Urgence.js"],"names":["React","AsyncStorage","Button","withNavigation","connect","Permissions","Location","widthPercentageToDP","wp","heightPercentageToDP","hp","Footer","axios","Bdd","Header","TopMenu","BottomMenu","ScrollView","emergency","API_KEY","Urgence","findNum","_getCountryCodeByLocation","code","console","log","askAsync","LOCATION","status","setState","errorMessage","getCurrentPositionAsync","location","get","coords","latitude","longitude","then","response","globalRes","data","results","address_components","filter","el","types","includes","resObj","short_name","res","type","msg","props","user","id","user_id","post","api_url","contacts","map","contact","email","length","mail","catch","err","uuid","token","phone","url","Platform","OS","Linking","canOpenURL","supported","openURL","styles","container","under_ios","under","navigation","main","title1","buttonStyle","e","onCLickUrgence","callPerson","width","height","marginTop","require","buttonText","Component","StyleSheet","create","flex","backgroundColor","alignItems","justifyContent","footer","paddingBottom","borderBottomColor","borderBottomWidth","color","textAlign","fontSize","fontWeight","marginBottom","zIndex","mapStateToProps","store","mapDispatchToProps"],"mappings":"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","sourcesContent":["import React from 'react'\r\nimport { StyleSheet, Text, View, AsyncStorage, Linking, TouchableOpacity, Image } from 'react-native';\r\nimport { Button } from 'react-native-elements'\r\nimport { withNavigation } from 'react-navigation'\r\nimport { connect } from 'react-redux'\r\nimport * as Permissions from 'expo-permissions';\r\nimport * as Location from 'expo-location';\r\nimport {\r\n  widthPercentageToDP as wp,\r\n  heightPercentageToDP as hp,\r\n} from 'react-native-responsive-screen'\r\nimport Footer from \"./Menu/Footer\"\r\nimport axios from 'axios'\r\nimport Bdd from '../API/Bdd'\r\nimport Header from './Menu/Header'\r\nimport TopMenu from \"./Menu/TopMenu\"\r\nimport BottomMenu from \"./Menu/BottomMenu\"\r\nimport { ScrollView } from 'react-native-gesture-handler'\r\nimport { emergency } from \"../API/emergency\";\r\nconst API_KEY = 'AIzaSyApjuz39FHMGBsy9lo7FobJQJtZKNra8P8';\r\nclass Urgence extends React.Component {\r\n\r\n  componentDidMount() {\r\n\r\n\r\n    let res = emergency.data[0]\r\n    console.log(this.findNum())\r\n  }\r\n\r\n  findNum = async () => {\r\n    let code = await this._getCountryCodeByLocation()\r\n\r\n    console.log(code)\r\n  }\r\n\r\n  _getCountryCodeByLocation = async () => {\r\n    let { status } = await Permissions.askAsync(Permissions.LOCATION);\r\n    if (status !== 'granted') {\r\n      this.setState({\r\n        errorMessage: 'Permission to access location was denied',\r\n      });\r\n    }\r\n\r\n    let location = await Location.getCurrentPositionAsync({});\r\n\r\n    let code = \"\"\r\n    await axios.get(\"https://maps.googleapis.com/maps/api/geocode/json?latlng=\" + location.coords.latitude + \",\" + location.coords.longitude + \"&key=\" + API_KEY)\r\n      .then(async response => {\r\n        const globalRes = response.data.results[0].address_components\r\n\r\n        let resObj = await globalRes.filter(el => {\r\n          return el.types.includes(\"country\")\r\n        })\r\n        console.log(resObj.short_name)\r\n        code = resObj.short_name\r\n      })\r\n    return code\r\n  };\r\n\r\n\r\n  onCLickUrgence(type, msg) {\r\n\r\n    console.log(this.props.user.user.data.user[0].id)\r\n    let data = {\r\n      user_id: this.props.user.user.data.user[0].id\r\n    }\r\n\r\n    axios.post(Bdd.api_url + '/api/contact/all', data)\r\n      .then((res) => {\r\n        console.log('res', res.data);\r\n        let contacts = res.data.contacts;\r\n\r\n        contacts.map((contact) => {\r\n          let user = {\r\n            email: contact.email\r\n          }\r\n\r\n          axios.post(Bdd.api_url + '/api/user/byMail', user)\r\n            .then((user) => {\r\n              console.log('response par email', user)\r\n\r\n              if (user.data.user.length !== 0) {\r\n\r\n                let mail = {\r\n                  email: user.data.user[0].email,\r\n                  msg: msg,\r\n                  type: type\r\n                }\r\n\r\n                axios.post(Bdd.api_url + '/api/com/sendMail', mail)\r\n                  .then((response) => {\r\n\r\n                    console.log(response)\r\n                  }).catch((err) => {\r\n                    console.log('err', err);\r\n\r\n                  })\r\n\r\n                let uuid = {\r\n                  token: user.data.user[0].uuid,\r\n                  msg: msg,\r\n\r\n                }\r\n                axios.post(Bdd.api_url + '/api/com/notif', uuid)\r\n                  .then((response) => {\r\n\r\n                    console.log(response)\r\n                  }).catch((err) => {\r\n                    console.log('err', err);\r\n\r\n                  })\r\n\r\n\r\n\r\n              }\r\n            }).catch((err) => {\r\n              console.log('err', err);\r\n\r\n            })\r\n        })\r\n\r\n      }).catch((err) => {\r\n        console.log('err', err);\r\n\r\n      })\r\n  }\r\n\r\n  callPerson(phone) {\r\n    let url;\r\n    if (Platform.OS === 'ios') {\r\n      url = 'tel://' + phone\r\n    }\r\n    else if (Platform.OS === 'android') {\r\n      url = 'tel:' + phone\r\n\r\n    }\r\n\r\n    Linking.canOpenURL(url)\r\n      .then((supported) => {\r\n        if (supported) {\r\n          return Linking.openURL(url)\r\n            .catch(() => null);\r\n        }\r\n      });\r\n\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <View style={styles.container}>\r\n        <View style={Platform.OS === 'ios' ? styles.under_ios : styles.under}>\r\n          <TopMenu navigation={this.props.navigation} />\r\n        </View>\r\n        <ScrollView style={styles.main}>\r\n          <Text style={styles.title1}>APPEL D'URGENCE</Text>\r\n          <TouchableOpacity\r\n            style={styles.buttonStyle}\r\n            onPress={(e) => {\r\n              this.onCLickUrgence('Accident', \"Attention accident, votre contact d'urgence a déclenché son bouton\");\r\n              this.callPerson('18');\r\n            }}\r\n            title=\"Accident\"\r\n          >\r\n            <Image\r\n              style={{ width: wp('15%'), height: wp('15%'), marginTop: hp('1%') }}\r\n              source={require('../images/accident.png')}\r\n            />\r\n            <Text style={styles.buttonText}>ACCIDENT</Text></TouchableOpacity>\r\n          <TouchableOpacity\r\n            style={styles.buttonStyle}\r\n            onPress={(e) => {\r\n              this.onCLickUrgence('Malaise', \"Attention malaise, votre contact d'urgence a déclenché son bouton\")\r\n              this.callPerson('15')\r\n            }}\r\n            title=\"Malaise\"\r\n          >\r\n            <Image\r\n              style={{ width: wp('15%'), height: wp('15%'), marginTop: hp('1%') }}\r\n              source={require('../images/malaise.png')}\r\n            />\r\n            <Text style={styles.buttonText}>MALAISE</Text></TouchableOpacity>\r\n\r\n          <TouchableOpacity\r\n            style={styles.buttonStyle}\r\n            onPress={(e) => {\r\n              this.onCLickUrgence('Agression', \"Attention agression, votre contact d'urgence a déclenché son bouton\")\r\n              this.callPerson('17')\r\n            }}\r\n            title=\"Agression\"\r\n          >\r\n            <Image\r\n              style={{ width: wp('15%'), height: wp('15%'), marginTop: hp('1%') }}\r\n              source={require('../images/agression.png')}\r\n            />\r\n            <Text style={styles.buttonText}>AGRESSION</Text></TouchableOpacity>\r\n          <TouchableOpacity\r\n            style={styles.buttonStyle}\r\n            onPress={(e) => {\r\n              this.onCLickUrgence('Agression', \"Attention agression, votre contact d'urgence a déclenché son bouton\")\r\n              this.callPerson('0651508656')\r\n            }}\r\n            title=\"Agression\"\r\n          >\r\n            <Image\r\n              style={{ width: wp('15%'), height: wp('15%'), marginTop: hp('1%') }}\r\n              source={require('../images/Detresse.png')}\r\n            />\r\n            <Text style={styles.buttonText}>DETRESSE</Text></TouchableOpacity>\r\n        </ScrollView>\r\n        <View>\r\n          <BottomMenu navigation={this.props.navigation} />\r\n        </View>\r\n      </View>\r\n    );\r\n  }\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n    backgroundColor: '#00C1B4',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n  },\r\n  main: {\r\n    height: hp('70%'),\r\n    marginTop: hp('3%')\r\n\r\n  },\r\n  footer: {\r\n    height: hp(\"10%\"),\r\n  },\r\n  buttonStyle: {\r\n    marginTop: hp(\"2%\"),\r\n    width: wp(\"70%\"),\r\n    backgroundColor: \"white\",\r\n    //paddingTop: hp('1%'),\r\n    paddingBottom: hp('2%'),\r\n    //marginBottom: hp(\"2%\"),\r\n    borderBottomColor: \"#008AC8\",\r\n    borderBottomWidth: 6,\r\n    alignItems: \"center\"\r\n  },\r\n  buttonText: {\r\n    color: '#00C1B4',\r\n    textAlign: \"center\",\r\n    fontSize: 16,\r\n    fontWeight: \"bold\"\r\n  },\r\n  title1: {\r\n    fontSize: 30,\r\n    color: \"white\",\r\n    marginBottom: hp('3%'),\r\n    fontWeight: \"bold\"\r\n  },\r\n  under: {\r\n    height: hp('10%'),\r\n    width: wp(\"100%\"),\r\n    zIndex: 99\r\n  },\r\n});\r\n\r\nconst mapStateToProps = (store) => {\r\n  return {\r\n    user: store.user,\r\n    contact: store.contact\r\n  }\r\n}\r\n\r\nconst mapDispatchToProps = {\r\n\r\n}\r\n\r\n\r\nexport default connect(mapStateToProps)(Urgence)"]},"metadata":{},"sourceType":"module"}